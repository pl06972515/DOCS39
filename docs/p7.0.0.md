<br/>

>[!NOTE|style: flat|label: ç®€è¦è¯´æ˜Ž ]
>
>- åŸºäºŽ`XML`æ–‡ä»¶çš„é…ç½®æº  [`namespaceï¼šMicrosoft.Extensions.Configuration.Xml`]
>
>   [<span style='color:#008B00'>[ðŸ‘“ NuGet - Microsoft.Extensions.Configuration.Xml ]</span>](https://www.nuget.org/packages/Microsoft.Extensions.Configuration.Xml/ ':target=_blank') 
>
>
>
><br/>

## âœ´ XmlConfigurationSource :id=H2_1

<!-- tabs:start -->

#### **XmlConfigurationSource**

```csharp
public class XmlConfigurationSource : FileConfigurationSource
{
    
      public override IConfigurationProvider Build(IConfigurationBuilder builder)
      {
            //åˆå§‹åŒ–: IFileProvider
            base.EnsureDefaults(builder);
            return new XmlConfigurationProvider(this);
      }
    
}


```



#### **XmlConfigurationProvider**

```csharp
public class XmlConfigurationProvider : FileConfigurationProvider
{
    
      public XmlConfigurationProvider(JsonConfigurationSource source) 
          : base(source) { }

      public override void Load(Stream stream)
      {
            try { base.Data = XmlStreamConfigurationProvider.Parse(stream); }
            catch (JsonException e) {
                 throw new FormatException(SR.Error_JSONParseError, e);
            }
      }
    
}


```



#### **XmlConfigurationExtensions**

```csharp
public static class XmlConfigurationExtensions
{
       
      public static IConfigurationBuilder AddXmlFile(this IConfigurationBuilder builder, string path)
          => AddJsonFile(builder, provider: null, path: path, optional: false, reloadOnChange: false);
      public static IConfigurationBuilder AddXmlFile(this IConfigurationBuilder builder, string path, bool optional);
          => AddJsonFile(builder, provider: null, path: path, optional: optional, reloadOnChange: false);
       
      public static IConfigurationBuilder AddXmlFile(this IConfigurationBuilder builder,
           IFileProvider? provider, 
           string path, 
           bool optional, 
           bool reloadOnChange
      ) {
            
            return builder.AddXmlFile(source =>
            {
                  source.FileProvider = provider;
                  source.Path = path;
                  source.Optional = optional;
                  source.ReloadOnChange = reloadOnChange;
                  source.ResolveFileProvider();
            });
      }
    
      public static IConfigurationBuilder AddXmlFile(this IConfigurationBuilder builder, Action<XmlConfigurationSource>? configureSource)
      {
            XmlConfigurationSource configureSource = new XmlConfigurationSource();
            configureSource(configureSource);
            builder.Add(configureSource);
      }
    
}


```



<!-- tabs:end -->



## âœ´ XmlStreamConfigurationSource :id=H2_2



<!-- tabs:start -->

####  **XmlStreamConfigurationSource**

```csharp
public class XmlStreamConfigurationSource : StreamConfigurationSource
{
      public override IConfigurationProvider Build(IConfigurationBuilder builder)
          => new XmlStreamConfigurationProvider(this);
}


```



####  **XmlStreamConfigurationProvider**

```csharp
public class XmlStreamConfigurationProvider : StreamConfigurationProvider
{
    
      public XmlStreamConfigurationProvider(JsonStreamConfigurationSource source) 
          : base(source) { }

      public override void Load(Stream stream)
          => Data = this.Read(stream, XmlDocumentDecryptor.Instance);
      
}


```

 

#### **XmlConfigurationExtensions**

```csharp
public static class XmlConfigurationExtensions
{
    
      public static IConfigurationBuilder AddXmlStream(this IConfigurationBuilder builder, Stream stream)
      {
           XmlStreamConfigurationSource Source = new XmlStreamConfigurationSource { Stream = stream };
           return builder.Add(Source);
      }
    
}


```

<!-- tabs:end -->





