```shell
echo '[ 当前步骤 ] 制作镜像'
docker build --no-cache -f ./testWebApp/Dockerfile --tag testwebapp:${BUILD_NUMBER} .
echo '[ 当前步骤 ] 清理镜像'
docker image prune -f


```

```shell
echo '[ 当前步骤 ] 容器启动'
# 强制删除现有容器
docker rm -f testwebapp || true
# 容器启动 ( HTTP )
# HTTPS + 挂载证书: 请查看官方提供的 docker-compose.yml
# ASPNETCORE_HTTPS_PORTS = 8089
# - ${APPDATA}/ASP.NET/Https:/home/app/.aspnet/https:ro 
# - ${APPDATA}/ASP.NET/Https:/root/.aspnet/https:ro
docker run -d --name testwebapp \
  --restart=always \
  -p 7008:7008 \
  -e ASPNETCORE_ENVIRONMENT=Development \
  -e ASPNETCORE_HTTP_PORTS=7008 \
  testwebapp:${BUILD_NUMBER}

echo '[ 当前步骤 ] 启动日志'
sleep 1
docker logs --tail 20 testwebapp


```



```shell
echo '[ 当前步骤 ] 推送仓库'
docker login 192.168.8.144:8087 -u admin -p 372577325
docker tag testwebapp:${BUILD_NUMBER} 192.168.8.144:8087/pm2-services/testwebapp:${BUILD_NUMBER}
docker push 192.168.8.144:8087/pm2-services/testwebapp:${BUILD_NUMBER}


```

