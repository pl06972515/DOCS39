<br/>



>[!WARNING|style: flat|label:  简要说明 ]
>
>- 配置源采用一个字典对象`IEnumerable<KeyValuePair<string, string>>`作为存储原始数据的容器
>
>   [`namespace：Microsoft.Extensions.Configuration.Memory`]
>
>
><br/>

<!-- tabs:start -->

#### **IConfigurationSource**

```csharp
public class MemoryConfigurationSource : IConfigurationSource
{

     # [ 字典 ]原始数据
     public IEnumerable<KeyValuePair<string, string>> InitialData { get; set; }
     public IConfigurationProvider Build(IConfigurationBuilder builder)
         => new MemoryConfigurationProvider(this);

}


```



#### **IConfigurationProvider**

```csharp
public class MemoryConfigurationProvider : ConfigurationProvider, 
                                           IEnumerable<KeyValuePair<string, string>>
{

      private readonly MemoryConfigurationSource _source;
      public MemoryConfigurationProvider(MemoryConfigurationSource source)
      {

            this._source = source;
            if (_source.InitialData != null)
            {
                  foreach (KeyValuePair<string, string> pair in _source.InitialData)
                      base.Data.Add(pair.Key, pair.Value);
            }

      }

      public void Add(string key, string value) => base.Data.Add(key, value);
      public IEnumerator<KeyValuePair<string, string>> GetEnumerator() => Data.GetEnumerator();
      IEnumerator IEnumerable.GetEnumerator() => GetEnumerator();

}


```



#### **MemoryConfigurationBuilderExtensions**

```csharp
public static class MemoryConfigurationBuilderExtensions
{

      public static IConfigurationBuilder AddInMemoryCollection(this IConfigurationBuilder configurationBuilder,
           IEnumerable<KeyValuePair<string, string>> initialData)
      {
           configurationBuilder.Add(new MemoryConfigurationSource { InitialData = initialData });
           return configurationBuilder;
      }

}


```



<!-- tabs:end -->

```csharp
var source = new Dictionary<string, string>
{
	 ["A:B:C"] = "ABC"
};
IConfigurationRoot root = new ConfigurationBuilder()
							 .AddInMemoryCollection(source)
							 .Build();

IConfigurationSection section = root.GetSection("A").GetSection("B:C");       
Console.WriteLine(section.Value);


```

