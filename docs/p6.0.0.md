<br/>

>[!NOTE|style: flat|label: ç®€è¦è¯´æ˜Ž ]
>
>- åŸºäºŽ`JSON`æ–‡ä»¶çš„é…ç½®æº  [`namespaceï¼šMicrosoft.Extensions.Configuration.Json`]
>
>   [<span style='color:#008B00'>[ðŸ‘“ NuGet - Microsoft.Extensions.Configuration.Json ]</span>](https://www.nuget.org/packages/Microsoft.Extensions.Configuration.Json/ ':target=_blank') 
>
>
>
>
> <br/>

## âœ´ FileConfigurationSource :id=H2_1

<!-- tabs:start -->

#### **JsonConfigurationSource**

```csharp
public class JsonConfigurationSource : FileConfigurationSource
{
    
      public override IConfigurationProvider Build(IConfigurationBuilder builder)
      {
          
            // [ å¸®åŠ©æ–¹æ³• ] é»˜è®¤æ–‡ä»¶æ ¹ç›®å½• new PhysicalFileProvider(AppContext.BaseDirectory ?? string.Empty)
            base.EnsureDefaults(builder);
            return new JsonConfigurationProvider(this);
          
      }
    
}


```



#### **JsonConfigurationProvider**

```csharp
public class JsonConfigurationProvider : FileConfigurationProvider
{
    
      public JsonConfigurationProvider(JsonConfigurationSource source) 
          : base(source) { }

      public override void Load(Stream stream)
      {
            try { base.Data = JsonConfigurationFileParser.Parse(stream); }
            catch (JsonException e) {
                 throw new FormatException(SR.Error_JSONParseError, e);
            }
      }
    
}


```



#### **JsonConfigurationExtensions**

```csharp
public static class JsonConfigurationExtensions
{
       
      public static IConfigurationBuilder AddJsonFile(this IConfigurationBuilder builder,
           IFileProvider? provider = null, 
           string path,    // ç›¸å¯¹è·¯å¾„
           bool optional = false,  
           bool reloadOnChange = false
      ) {
            
            return builder.AddJsonFile(source =>
            {
                  source.FileProvider = provider;
                  source.Path = path;
                  source.Optional = optional;
                  source.ReloadOnChange = reloadOnChange;
                  source.ResolveFileProvider();
            });
      }
    
      public static IConfigurationBuilder AddJsonFile(this IConfigurationBuilder builder, Action<JsonConfigurationSource>? configureSource)
      {
            JsonConfigurationSource configureSource = new JsonConfigurationSource();
            configureSource(configureSource);
            builder.Add(configureSource);
      }
    
}


```



<!-- tabs:end -->

## âœ´ JsonStreamConfigurationSource :id=H2_2

<!-- tabs:start -->

#### **JsonStreamConfigurationSource**

```csharp
public class JsonStreamConfigurationSource : StreamConfigurationSource
{
     public override IConfigurationProvider Build(IConfigurationBuilder builder)
         => new JsonStreamConfigurationProvider(this);
}


```







#### **JsonStreamConfigurationProvider**

```csharp
public class JsonStreamConfigurationProvider : StreamConfigurationProvider
{
    
     public JsonStreamConfigurationProvider(JsonStreamConfigurationSource source) 
         : base(source) { }

     public override void Load(Stream stream)
         => Data = JsonConfigurationFileParser.Parse(stream);
      
}


```



#### **JsonConfigurationExtensions**

```csharp
public static class JsonConfigurationExtensions
{
    
     public static IConfigurationBuilder AddJsonStream(this IConfigurationBuilder builder, Stream stream)
     {
          JsonStreamConfigurationSource Source = new JsonStreamConfigurationSource { Stream = stream };
          return builder.Add(Source);
     }
    
}


```

<!-- tabs:end -->





>
>
>```csharp
>public class User
>{
>	  public string Name { get; set; }
>	  public int Age { get; set; }
>}
>
>
>```
>
>---
>
>
>
>```csharp
>string @jsonStr = """
>     {
>         "Name": "å¼ ä¸‰",
>         "Age": 20
>     }
>     """;
>         
>MemoryStream stream = new MemoryStream(System.Text.Encoding.UTF8.GetBytes(@jsonStr));
>IConfigurationRoot root = new ConfigurationBuilder()
>							 .AddJsonStream(stream)
>							 .Build();
>
>User? user = root.Get<User>();
>Console.WriteLine(user.Name);
>
>
>```
>
><br/>





